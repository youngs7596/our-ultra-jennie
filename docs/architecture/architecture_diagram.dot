digraph MyLittleJennieFlow {
    // 1. 전역 설정
    graph [
        rankdir=TB,
        splines=ortho,
        nodesep=0.4,
        ranksep=0.8,
        fontname="Noto Sans KR",
        fontsize=14,
        label="My Little Jennie - Architecture Flow",
        fontcolor="#DAFFDE",
        bgcolor="transparent"
    ];
    node [
        shape=box,
        style="rounded,filled",
        fillcolor="#1a1a1a",
        fontcolor="#DAFFDE",
        color="#DEFF9A",
        fontname="Noto Sans KR",
        fontsize=12
    ];
    edge [
        color="#DEFF9A",
        fontcolor="#DAFFDE",
        fontsize=10
    ];

    // 2. Ingestion Workflow
    subgraph cluster_ingestion {
        label = "[Ingestion Workflow] (Batch/Async)";
        style="rounded";
        fontcolor="#DEFF9A";
        color="#333";
        bgcolor="#0d0d0d";

        // News Flow
        crawler [label="Crawler\n(News RSS)"];
        langchain [label="LangChain\n(Chunking)"];
        vertex_ai_embed [label="Vertex AI\n(Embedding)"];
        chromadb [label="ChromaDB\n(Vector Store)"];
        crawler -> langchain -> vertex_ai_embed -> chromadb;

        // Watchlist Flow
        scout [label="Scout\n(KIS API)"];
        oracle_db [label="Oracle DB\n(Watchlist)"];
        scout -> oracle_db;
    }

    // 3. Decision Workflow
    subgraph cluster_decision {
        label = "[Decision Workflow] (Real-time)";
        style="rounded";
        fontcolor="#DEFF9A";
        color="#333";
        bgcolor="#0d0d0d";
        
        agent [label="Agent\n(Trigger)"];
        rag_cache [label="DB + RAG Cache\n(데이터 조회)"];
        strategy_engine [label="Strategy Engine\n(1차 신호 생성)"];
        gemini_llm [label="Gemini LLM\n(최종 결재)"];
        kis_api [label="KIS API\n(주문 실행)"];
        
        agent -> rag_cache -> strategy_engine -> gemini_llm -> kis_api;
    }

    // 4. 데이터 공급 링크
    chromadb -> rag_cache [
        style=dashed, 
        color="#DEFF9A", 
        arrowhead=normal
    ];
    oracle_db -> rag_cache [
        style=dashed, 
        color="#DEFF9A", 
        arrowhead=normal
    ];
}