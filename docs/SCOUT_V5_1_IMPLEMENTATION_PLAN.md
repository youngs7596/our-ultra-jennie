# 구현 계획: Scout V5.1 로직 업데이트

## 목표
최근 수행한 팩터 분석 및 LLM 브레인스토밍 결과를 바탕으로 Scout 스코어링 로직을 V5.1로 업데이트합니다.
핵심은 "좋은 뉴스 = 매도"라는 잘못된 역신호 가설을 폐기하고, 외국인 수급의 "눌림목 매수" 패턴을 정량화하여 반영하는 것입니다.

## 주요 변경 사항

### 1. `shared/llm_prompts.py` (LLM 로직 업데이트)
- **"역신호" 경고 삭제**: "좋은 뉴스는 매도 신호다"라는 기존 지시사항을 삭제합니다.
- **새로운 역할 정의**: LLM의 역할을 **"리스크 필터(Risk Filter)"** 및 **"컨텍스트 검증기(Context Validator)"**로 재정의합니다.
    - **리스크 필터**: 횡령, CEO 리스크, 규제 등 치명적 결함을 감지합니다. 발견 시 **Kill Switch (점수 0점)**를 발동합니다.
    - **컨텍스트 검증기**: 뉴스가 현재의 정량적 신호(주가 상승 등)를 뒷받침하는지 확인합니다.
- **섹터 컨텍스트**: 가능하다면 섹터 모멘텀과의 일관성을 고려하도록 지시합니다.

### 2. `shared/hybrid_scoring` (스코어링 로직 업데이트)
#### `quant_scorer.py` 수정
- **외국인 수급 스코어링 (신규)**: "눌림목 매수(Dip Buying)" 로직을 구현합니다.
    - **기본 점수**: 외국인 순매수량의 순위/정규화 점수.
    - **다이버전스 보너스**: `IF (외국인 순매수 > 상위 임계값) AND (5일 주가 변동률 < 0) THEN 보너스 점수 부여`.
    - **가중치 조정**: 외국인 팩터 가중치를 확대합니다 (예: 20~25%).
- **뉴스 팩터 가중치**: 뉴스 점수의 직접적인 반영 비중을 축소합니다 (예: 5~10%).

#### `hybrid_scorer.py` 수정
- **가중치 재분배**: 새로운 가중치(Quant/Foreign 중심, LLM 보조)를 반영합니다.
- **Kill Switch 통합**: LLM이 "Critical Risk"를 반환할 경우, 최종 점수를 강제로 0점으로 만듭니다.

## 검증 계획

### 자동화 테스트
- **단위 테스트**: `quant_scorer.py`에 대해 모의 데이터(Mock Data)를 사용하여 외국인 수급 시나리오(눌림목 vs 추격매수)를 테스트합니다.
- **프롬프트 테스트**: 샘플 "호재" 및 "악재" 뉴스로 프롬프트를 드라이런(Dry-run)하여 "역신호"가 사라졌는지, "리스크 필터"가 작동하는지 확인합니다.

### 수동 검증
- **Scout 실행**: 소수의 종목(예: 삼성전자 등 최근 이슈 종목)에 대해 전체 파이프라인을 실행하여, 로직이 의도한 대로 더 단순하고 합리적인 결과를 내는지 확인합니다.
